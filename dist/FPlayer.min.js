this.fangkehou=this.fangkehou||{},function(){function t(t,e){this.mContainer=t,this._mView=(new DOMParser).parseFromString('<div class="fplayer_panel">\n    <div class="fplayer_control_panel_background">\n        <div class="fplayer_control_panel">\n            <div class="fplayer_detail_panel">\n                <p class="fplayer_detail_title">FPlayer</p>\n                <p class="fplayer_detail_artist">Team Fangkehou</p>\n            </div>\n            <div class="fplayer_button_controller" data-action="previous"><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="48" height="48" fill="white" fill-opacity="0.01"/><path d="M34 36L22 24L34 12" stroke="#FFF" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path d="M14 12V36" stroke="#FFF" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>\n            </div>\n            <div class="fplayer_button_controller fplayer_play_or_pause" data-action="play"><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="48" height="48" fill="white" fill-opacity="0.01"/><path d="M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z" fill="none" stroke="#FFF" stroke-width="4" stroke-linejoin="round"/><path d="M20 24V17.0718L26 20.5359L32 24L26 27.4641L20 30.9282V24Z" fill="none" stroke="#FFF" stroke-width="4" stroke-linejoin="round"/></svg>\n            </div>\n            <div class="fplayer_button_controller" data-action="next"><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="48" height="48" fill="white" fill-opacity="0.01"/><path d="M14 12L26 24L14 36" stroke="#FFF" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path d="M34 12V36" stroke="#FFF" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>\n            </div>\n            <div class="fplayer_button_controller" data-action="list"><svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M24 19H40" stroke="#FFF" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path d="M24 10H40" stroke="#FFF" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path d="M8 38H40" stroke="#FFF" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path d="M8 28H40" stroke="#FFF" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path d="M8 10L16 15L8 20V10Z" fill="none" stroke="#FFF" stroke-width="4" stroke-linejoin="round"/></svg>\n            </div>\n        </div>\n    </div>\n    <div class="fplayer_animation fplayer_lyric_panel">\n        <div class="fplayer_lyric_wrapper">\n            <p data-id="-1">无歌词</p>\n        </div>\n    </div>\n    <div class="fplayer_list_panel">\n        <div class="fplayer_list_item" data-id="-1" style=\'background-image: url("data:image/svg+xml;utf8,'+'<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M512 0a512 512 0 1 0 512 512 512 512 0 0 0-512-512z m378.24 448h-197.76a187.52 187.52 0 0 0-37.12-64l116.48-155.52A384 384 0 0 1 890.24 448zM576 512a64 64 0 1 1-64-64 64 64 0 0 1 64 64z m-64 384a384 384 0 1 1 152.32-736.64L541.44 323.2A147.84 147.84 0 0 0 512 320a192 192 0 1 0 180.48 256h197.76A384 384 0 0 1 512 896z" fill="%23FFFFFF"/></svg>'.replaceAll('"','\\"')+'");\'>\n            <p class="fplayer_list_content" style="top: 0;">FPlayer</p>\n            <p class="fplayer_list_content" style="bottom: 0;">Team Fangkehou</p>\n        </div>\n    </div>\n</div>',"text/html").querySelector(".fplayer_panel"),t.appendChild(this._mView);let i=this._mView.getElementsByClassName("fplayer_button_controller");for(let t=0;t<i.length;t++)i[t].mFPlayerInstance=this,i[t].addEventListener("click",function(){switch(this.dataset.action){case"previous":this.mFPlayerInstance.previous();break;case"pause":this.dataset.action="play",this.mFPlayerInstance.pause();break;case"play":this.dataset.action="pause",this.mFPlayerInstance.play();break;case"next":this.mFPlayerInstance.next();break;case"list":this.mFPlayerInstance.openOrCloseList()}});let s=this._mView.querySelector(".fplayer_lyric_panel"),n=(s.mFPlayerInstance=this,s.addEventListener("click",function(){this.mFPlayerInstance.openOrCloseLyric()}),this._mView.querySelector(".fplayer_list_panel"));n.mFPlayerInstance=this,n.addEventListener("click",function(){this.mFPlayerInstance.openOrCloseList()}),this.mMode=e.mode||fangkehou.FPlayer.MODE_LIST,this.mAutoSkip=e.autoSkip||!0,this._mPlayer=new Audio,(this._mPlayer.mFPlayerInstance=this)._mPlayer.addEventListener("canplaythrough",function(){this.mFPlayerInstance.mListener(this.mFPlayerInstance,fangkehou.FPlayer.ACTION_ON_LOAD),this.mFPlayerInstance._mIsPlaying&&this.play().catch()}),this._mPlayer.addEventListener("pause",function(){this.mFPlayerInstance._mIsPlaying&&(console.log("end of song"),this.mFPlayerInstance.mListener(this.mFPlayerInstance,fangkehou.FPlayer.ACTION_ON_NEXT),this.mFPlayerInstance.onNext())}),this._mPlayer.addEventListener("error",function(){console.log("failed to load"),this.mFPlayerInstance.mListener(this.mFPlayerInstance,fangkehou.FPlayer.ACTION_ON_FAIL),this.mFPlayerInstance._mIsPlaying&&(this.mFPlayerInstance.mAutoSkip?this.mFPlayerInstance.next():(this.mFPlayerInstance._mView.querySelector(".fplayer_detail_title").innerText="There is an error!",this.mFPlayerInstance._mView.querySelector(".fplayer_detail_title").innerText="Team Fangkehou",this.mFPlayerInstance.pause()))}),this._mPlayer.addEventListener("timeupdate",function(){this.mFPlayerInstance._doLyricChange(this.currentTime)}),console.log("%c FPlayer %c https://github.com/fangkehou-team/FPlayer","padding: 5px; font-weight: bold; font-size: 20px; color: #272727; background: #FFD033","padding: 5px; font-weight: bold; font-size: 20px; color: #272727; background: #9EFF3C")}let e=t.prototype;(e.constructor=t).create=function(t,e={}){return t instanceof HTMLElement?new this(t,e):"string"==typeof t&&document.getElementById(t)?new this(document.getElementById(t),e):void console.error("Unable to initialize FPlayer: No valid Container available")},t.ACTION_PREPARE_READY="prepare_ready",t.ACTION_PREPARE_FAIL="prepare_fail",t.ACTION_ON_PLAY="on_play",t.ACTION_ON_LOAD="on_load",t.ACTION_ON_PAUSE="on_pause",t.ACTION_ON_SWITCH="on_switch",t.ACTION_ON_NEXT="on_next",t.ACTION_ON_PREVIOUS="on_previous",t.ACTION_ON_FAIL="on_fail",t.MODE_SINGLE="single",t.MODE_LIST="list",t.MODE_RANDOM="random",e.mContainer=void 0,e.mTheme=void 0,e.mMusicList=[],e.mMode=void 0,e.mListener=function(t,e){},e.mAutoSkip=!0,e._mView=void 0,e._mVolume=void 0,e._mPlayList=[],e._mCurrentId=void 0,e._mPlayer=void 0,e._mIsPlaying=!1,e._mCurrentLyric=[],e._mCurrentLyricId=void 0,e._mCurrentLyricStartTime=void 0,e._mCurrentLyricEndTime=void 0,e._mIsShowList=!1,e._mIsShowLyric=!1,e.setTheme=function(t){this.mTheme=t},e.getTheme=function(){return this.mTheme},e.setMusicList=function(t){this.mMusicList=t,this._updateList(),this.switch(0)},e.getMusicList=function(){return this.mMusicList},e.addMusic=function(t){this.mMusicList[this.mMusicList.length]=t,this._mPlayList[this._mPlayList.length]=t,void 0===this._mCurrentId?this.switch(0):this._refreshList(),this._updateList()},e.setMode=function(t){this.mMode=t,this._refreshList()},e.getMode=function(){return this.mMode},e.setListener=function(t){this.mListener=t},e.openOrCloseList=function(){let t=this._mView.querySelector(".fplayer_list_panel");0==this._mIsShowList?(t.style.transform="translateY(0px)",this._mIsShowList=!0):(t.style.transform="translateY(160px)",this._mIsShowList=!1)},e.openOrCloseLyric=function(){let t=this._mView.querySelector(".fplayer_lyric_panel"),e=this._mView.querySelector(".fplayer_lyric_wrapper");0==this._mIsShowLyric?(t.style.height="100%",e.style.overflow="scroll",this._mIsShowLyric=!0):(t.style.height="40px",e.style.overflow="hidden",this._mIsShowLyric=!1)},e.play=function(){this._mView.querySelector(".fplayer_play_or_pause").innerHTML='<svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="48" height="48" fill="white" fill-opacity="0.01"/><path d="M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z" fill="none" stroke="#FFF" stroke-width="4" stroke-linejoin="round"/><path d="M19 18V30" stroke="#FFF" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/><path d="M29 18V30" stroke="#FFF" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>',this._mIsPlaying=!0,2<=this._mPlayer.readyState&&this._mPlayer.play().catch()},e.pause=function(){this._mView.querySelector(".fplayer_play_or_pause").innerHTML='<svg width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect width="48" height="48" fill="white" fill-opacity="0.01"/><path d="M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z" fill="none" stroke="#FFF" stroke-width="4" stroke-linejoin="round"/><path d="M20 24V17.0718L26 20.5359L32 24L26 27.4641L20 30.9282V24Z" fill="none" stroke="#FFF" stroke-width="4" stroke-linejoin="round"/></svg>',this._mIsPlaying=!1,this._mPlayer.pause()},e.setProgress=function(t){2<=this._mPlayer.readyState&&this._mPlayer.duration>=t&&(this._mPlayer.currentTime=t)},e.setVolume=function(t){0<=t&&t<=1?this._mPlayer.volume=t:console.error("FPlayer: Failed to set volume")},e.onNext=function(){if(console.log("onNext"),this.mMode===fangkehou.FPlayer.MODE_SINGLE)return console.log("single mode"),this._pushSong(this._mPlayList[0]),void this.mListener(this,fangkehou.FPlayer.ACTION_ON_NEXT);this.next()},e.next=function(){var t=this._mPlayList[0];this._mPlayList.shift(),this._mPlayList.push(t),t=this._mPlayList[0],this._pushSong(t),this.play(),this.mListener(this,fangkehou.FPlayer.ACTION_ON_NEXT)},e.previous=function(){var t=this._mPlayList[this._mPlayList.length-1];this._mPlayList.unshift(t),this._mPlayList.pop(),this._pushSong(t),this.mListener(this,fangkehou.FPlayer.ACTION_ON_PREVIOUS)},e.switch=function(e){this._mPlayList=[];for(let t=e;t<this.mMusicList.length;t++)this._mPlayList[this._mPlayList.length]=this.mMusicList[t];for(let t=0;t<e;t++)this._mPlayList[this._mPlayList.length]=this.mMusicList[t];this._refreshList();var t=this._mPlayList[0];this._pushSong(t),this.mListener(this,fangkehou.FPlayer.ACTION_ON_SWITCH)},e._updateList=function(){if(0!=this.mMusicList.length){let e="";for(let t=0;t<this.mMusicList.length;t++)e+='<div class="fplayer_list_item" data-id="'+t+'" style=\'background-image: url("'+this.mMusicList[t].cover+'");\'>\n    <p class="fplayer_list_content" style="top: 0;">'+this.mMusicList[t].name+'</p>\n    <p class="fplayer_list_content" style="bottom: 0;">'+this.mMusicList[t].artist+"</p>\n</div>";let i=(new DOMParser).parseFromString(e,"text/html").getElementsByClassName("fplayer_list_item"),s=this._mView.querySelector(".fplayer_list_panel");s.innerHTML="";for(let t=0;t<i.length;t++)i[t].mFPlayerInstance=this,i[t].addEventListener("click",function(){this.mFPlayerInstance.switch(this.dataset.id)}),s.appendChild(i[t])}},e._refreshList=function(){if(this.mMode===fangkehou.FPlayer.MODE_RANDOM){var e,i,s=this._mPlayList[0];this._mPlayList.shift();let t=this._mPlayList.length;for(;0<t;)e=Math.floor(Math.random()*t),i=this._mPlayList[t-1],this._mPlayList[t-1]=this._mPlayList[e],this._mPlayList[e]=i,t--;this._mPlayList.unshift(s)}},e._getIdByMusic=function(e){if(0==this.mMusicList.length)return-1;for(let t=0;t<this.mMusicList.length;t++)if(e.equals(this.mMusicList[t]))return t;return-1},e._pushSong=function(i){if(console.log("pushSong"),void 0!==this._mCurrentId&&i.equals(this.mMusicList[this._mCurrentId]))return console.log("single"),void(2<=this._mPlayer.readyState&&this._mPlayer.play().catch());if(console.log("next"),this._mCurrentId=this._getIdByMusic(i),this._mCurrentLyric=i.lrc,this._switchLyric(0),this._mView.querySelector(".fplayer_detail_title").innerHTML=i.name,this._mView.querySelector(".fplayer_detail_artist").innerHTML=i.artist,this._mView.querySelector(".fplayer_control_panel_background").style.backgroundImage='url("'+i.cover+'")',0<i.lrc.length){let e="";for(let t=0;t<i.lrc.length;t++)e+='<p data-id="'+t+'">'+i.lrc[t].lyric+"</p>";this._mView.querySelector(".fplayer_lyric_wrapper").innerHTML=e}this._mPlayer.src=i.content,this._mPlayer.load()},e._doLyricChange=function(e){if(!(e>=this._mCurrentLyricStartTime&&e<this._mCurrentLyricEndTime))if(e>=this._mCurrentLyricEndTime&&this._mCurrentLyricId<this._mCurrentLyric.length-1){for(let t=this._mCurrentLyricId;t<this._mCurrentLyric.length;t++)if(e<=this._mCurrentLyric[t].time){this._switchLyric(t-1);break}}else if(e<=this._mCurrentLyricStartTime)for(let t=0;t<this._mCurrentLyricId+1;t++)if(e<=this._mCurrentLyric[t].time){this._switchLyric(t-1);break}},e._switchLyric=function(t){0!=this._mCurrentLyric[t=t<0?0:t].lyric.length?(this._mCurrentLyricId=t,this._mCurrentLyricStartTime=this._mCurrentLyric[t].time,void 0!==this._mCurrentLyric[t+1]&&(this._mCurrentLyricEndTime=this._mCurrentLyric[t+1].time),this._mView.querySelector(".fplayer_lyric_wrapper").style.transform="translateY("+-40*t+"px)"):(this._mCurrentLyricId=t,this._mCurrentLyricEndTime=this._mCurrentLyric[t+1].time)},fangkehou.FPlayer=t}(),this.fangkehou=this.fangkehou||{},function(){function t(t,e){this.time=t,this.lyric=e}let e=t.prototype;e.constructor=t,e.time=void 0,e.lyric=void 0,t.fromLrcString=function(t){let s=t.split("\n"),n=[],r=0;for(let e=0;e<s.length;e++){let t=s[e].replace(/[\s]*\[/g,"[").replace(/][\s]*/g,"]"),i=t.substring(t.indexOf("[")+1,t.indexOf("]")).split(":");if("offset"!=i[0].toLowerCase()){if(!isNaN(parseInt(i[0]))){i=t.match(/\[[0-9:.]*]/g);let e=0;for(let t=0;t<i.length;t++)e+=i[t].length;var l=t.substring(e);for(let e=0;e<i.length;e++){let t=i[e].substring(1,i[e].length);t=t.split(":"),t=parseFloat(Math.max(60*parseInt(t[0])+parseFloat(t[1])+r/1e3,0).toFixed(3)),n[n.length]=new fangkehou.Lyric(t,l)}}}else r=parseInt(i[1])}return n.sort((t,e)=>t.time-e.time),n},fangkehou.Lyric=t}(),this.fangkehou=this.fangkehou||{},function(){function t(t,e,i,s,n){this.name=t,this.artist=e,this.cover=i,"string"==typeof s&&(this.lrc=fangkehou.Lyric.fromLrcString(s)),s instanceof Array&&(this.lrc=s),"string"==typeof n&&(this.content=n),n instanceof Blob&&(this.content=URL.createObjectURL(n))}let e=t.prototype;e.constructor=t,e.name=void 0,e.artist=void 0,e.cover=void 0,e.lrc=void 0,e.content=void 0,e.equals=function(t){let e=0;return this.name===t.name&&e++,this.artist===t.artist&&e++,this.content===t.content&&e++,this.cover===t.cover&&e++,2<=e||this.lrc===t.lrc},fangkehou.Music=t}();
//# sourceMappingURL=../dist/FPlayer.min.js.map
