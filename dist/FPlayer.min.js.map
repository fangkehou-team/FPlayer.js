{"version":3,"file":"../js/FPlayer.min.js","sources":["FPlayer.js"],"sourcesContent":["//fangkehou命名空间，避免混淆\nthis.fangkehou = this.fangkehou || {};\n\n(function () {\n    /**\n     * <b>介绍</b><br />\n     * 欢迎使用FPlayer - Fangkehou Player ！\n     * 这是一款针对现代化浏览器设计的音乐播放器，具有界面美观，设置方便的优点（净能瞎吹-_-#）<br/>\n     * 您既可以直接以默认设置直接使用，也可以对FPlayer做出自定义的设置\n     *\n     * FPlayer允许用户通过参数对FPlayer外观，行为进行调整，具体规则及定义如下：\n     *\n     * @todo 参数的定义\n     * {string} mode: 播放模式（可选三个值：FPlayer.MODE_SINGLE 单曲循环, FPlayer.MODE_LIST 列表循环, FPlayer.MODE_RANDOM 列表随机）<br/>\n     * {boolean} autoPlay: 加载完成自动播放（仅第一首歌需要该设置，且需要用户同意自动播放或用户在网页内操作后才能自动播放）<br/>\n     * {boolean} autoSkip: 播放失败是否自动切换下一曲（true 或 false）\n     *\n     * 这是FPlayer构造函数，实现了FPlayer与容器和FPlayer设置参数的绑定，同时也承载FPlayer的类定义。\n     *\n     * @class FPlayer\n     * @constructor\n     *\n     * @param {HTMLElement} container FPlayer将要填充的容器\n     * @param {object} options FPlayer设置参数\n     *\n     * @example\n     * var FPlayer = new fangkehou.FPlayer.create(\"container\", {\n     *\n     * })\n     */\n    function FPlayer(container, options) {\n        this.mContainer = container;\n        //填充container\n        this._mView = new DOMParser().parseFromString('<div class=\"fplayer_panel\">\\n' +\n            '    <div class=\"fplayer_control_panel_background\">\\n' +\n            '        <div class=\"fplayer_control_panel\">\\n' +\n            '            <div class=\"fplayer_detail_panel\">\\n' +\n            '                <p class=\"fplayer_detail_title\">FPlayer</p>\\n' +\n            '                <p class=\"fplayer_detail_artist\">Team Fangkehou</p>\\n' +\n            '            </div>\\n' +\n            '            <div class=\"fplayer_button_controller\" data-action=\"previous\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><rect width=\"48\" height=\"48\" fill=\"white\" fill-opacity=\"0.01\"/><path d=\"M34 36L22 24L34 12\" stroke=\"#FFF\" stroke-width=\"4\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/><path d=\"M14 12V36\" stroke=\"#FFF\" stroke-width=\"4\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/></svg>\\n' +\n            '            </div>\\n' +\n            '            <div class=\"fplayer_button_controller fplayer_play_or_pause\" data-action=\"play\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><rect width=\"48\" height=\"48\" fill=\"white\" fill-opacity=\"0.01\"/><path d=\"M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z\" fill=\"none\" stroke=\"#FFF\" stroke-width=\"4\" stroke-linejoin=\"round\"/><path d=\"M20 24V17.0718L26 20.5359L32 24L26 27.4641L20 30.9282V24Z\" fill=\"none\" stroke=\"#FFF\" stroke-width=\"4\" stroke-linejoin=\"round\"/></svg>\\n' +\n            '            </div>\\n' +\n            '            <div class=\"fplayer_button_controller\" data-action=\"next\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><rect width=\"48\" height=\"48\" fill=\"white\" fill-opacity=\"0.01\"/><path d=\"M14 12L26 24L14 36\" stroke=\"#FFF\" stroke-width=\"4\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/><path d=\"M34 12V36\" stroke=\"#FFF\" stroke-width=\"4\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/></svg>\\n' +\n            '            </div>\\n' +\n            '            <div class=\"fplayer_button_controller\" data-action=\"list\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M24 19H40\" stroke=\"#FFF\" stroke-width=\"4\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/><path d=\"M24 10H40\" stroke=\"#FFF\" stroke-width=\"4\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/><path d=\"M8 38H40\" stroke=\"#FFF\" stroke-width=\"4\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/><path d=\"M8 28H40\" stroke=\"#FFF\" stroke-width=\"4\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/><path d=\"M8 10L16 15L8 20V10Z\" fill=\"none\" stroke=\"#FFF\" stroke-width=\"4\" stroke-linejoin=\"round\"/></svg>\\n' +\n            '            </div>\\n' +\n            '        </div>\\n' +\n            '    </div>\\n' +\n            '    <div class=\"fplayer_animation fplayer_lyric_panel\">\\n' +\n            '        <div class=\"fplayer_lyric_wrapper\">\\n' +\n            '            <p data-id=\"-1\">无歌词</p>\\n' +\n            '        </div>\\n' +\n            '    </div>\\n' +\n            '    <div class=\"fplayer_list_panel\">\\n' +\n            '        <div class=\"fplayer_list_item\" data-id=\"-1\" style=\\'background-image: url(\"data:image/svg+xml;utf8,' + '<svg class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"200\" height=\"200\"><path d=\"M512 0a512 512 0 1 0 512 512 512 512 0 0 0-512-512z m378.24 448h-197.76a187.52 187.52 0 0 0-37.12-64l116.48-155.52A384 384 0 0 1 890.24 448zM576 512a64 64 0 1 1-64-64 64 64 0 0 1 64 64z m-64 384a384 384 0 1 1 152.32-736.64L541.44 323.2A147.84 147.84 0 0 0 512 320a192 192 0 1 0 180.48 256h197.76A384 384 0 0 1 512 896z\" fill=\"%23FFFFFF\"/></svg>'.replaceAll(\"\\\"\", \"\\\\\\\"\") +'\");\\'>\\n' +\n            '            <p class=\"fplayer_list_content\" style=\"top: 0;\">FPlayer</p>\\n' +\n            '            <p class=\"fplayer_list_content\" style=\"bottom: 0;\">Team Fangkehou</p>\\n' +\n            '        </div>\\n' +\n        '    </div>\\n' +\n        '</div>', 'text/html').querySelector('.fplayer_panel');\n\n        container.appendChild(this._mView);\n        //获取控制按钮\n        let buttons = this._mView.getElementsByClassName(\"fplayer_button_controller\");\n        for(let i = 0; i < buttons.length; i++) {\n            buttons[i].mFPlayerInstance = this;\n            buttons[i].addEventListener(\"click\", function(){\n                switch(this.dataset.action){\n                    case \"previous\":\n                        this.mFPlayerInstance.previous();\n                        break;\n                    case \"pause\":\n                        this.dataset.action = \"play\";\n                        this.mFPlayerInstance.pause();\n                        break;\n                    case \"play\":\n                        this.dataset.action = \"pause\";\n                        this.mFPlayerInstance.play();\n                        break;\n                    case \"next\":\n                        this.mFPlayerInstance.next();\n                        break;\n                    case \"list\":\n                        this.mFPlayerInstance.openOrCloseList();\n                        break;\n                }\n            })\n        }\n\n        //设置歌词面板点击事件\n        let lyric_panel = this._mView.querySelector(\".fplayer_lyric_panel\");\n        lyric_panel.mFPlayerInstance = this;\n        lyric_panel.addEventListener(\"click\", function () {\n            this.mFPlayerInstance.openOrCloseLyric();\n        })\n        //设置播放列表面板点击事件\n        let list_panel = this._mView.querySelector(\".fplayer_list_panel\");\n        list_panel.mFPlayerInstance = this;\n        list_panel.addEventListener(\"click\", function () {\n            this.mFPlayerInstance.openOrCloseList();\n        })\n\n\n        this.mMode = options.mode || fangkehou.FPlayer.MODE_LIST;\n        this.mAutoSkip = options.autoSkip || true;\n\n\n        this._mPlayer = new Audio();\n        this._mPlayer.mFPlayerInstance = this;\n        this._mPlayer.addEventListener(\"canplaythrough\", function () {\n            this.mFPlayerInstance.mListener(this.mFPlayerInstance, fangkehou.FPlayer.ACTION_ON_LOAD);\n            if (this.mFPlayerInstance._mIsPlaying) {\n                this.play()\n                    .catch();\n            }\n        })\n        this._mPlayer.addEventListener(\"pause\", function () {\n            if (this.mFPlayerInstance._mIsPlaying) {\n                console.log(\"end of song\");\n                this.mFPlayerInstance.mListener(this.mFPlayerInstance, fangkehou.FPlayer.ACTION_ON_NEXT);\n                this.mFPlayerInstance.onNext();\n            }\n        })\n        this._mPlayer.addEventListener(\"error\", function () {\n            console.log(\"failed to load\")\n            this.mFPlayerInstance.mListener(this.mFPlayerInstance, fangkehou.FPlayer.ACTION_ON_FAIL);\n            if (this.mFPlayerInstance._mIsPlaying) {\n                if (this.mFPlayerInstance.mAutoSkip) {\n                    this.mFPlayerInstance.next();\n                } else {\n                    this.mFPlayerInstance._mView.querySelector('.fplayer_detail_title').innerText = 'There is an error!';\n                    this.mFPlayerInstance._mView.querySelector('.fplayer_detail_title').innerText = 'Team Fangkehou';\n                    this.mFPlayerInstance.pause();\n                }\n\n            }\n        })\n        this._mPlayer.addEventListener(\"timeupdate\", function(){\n            this.mFPlayerInstance._doLyricChange(this.currentTime);\n        })\n        console.log(\"%c FPlayer %c https://github.com/fangkehou-team/FPlayer\", \"padding: 5px; font-weight: bold; font-size: 20px; color: #272727; background: #FFD033\", \"padding: 5px; font-weight: bold; font-size: 20px; color: #272727; background: #9EFF3C\");\n    }\n\n    let f = FPlayer.prototype;\n    f.constructor = FPlayer;\n\n    /**\n     * FPlayer的创建函数，与 ‘new FPlayer(...)’ 的作用相同，但是container可以使用container的id代替\n     *\n     * @static\n     * @param {string|HTMLElement} container FPlayer将要填充的容器\n     * @param {object} options FPlayer设置参数，不设置则使用默认参数（详见 FPlayer构造函数 {@link FPlayer FPlayer()}）\n     *\n     * @return {FPlayer} FPlayer对象\n     *\n     * @todo 和yao对接，设置默认参数\n     */\n    FPlayer.create = function (container, options = {}) {\n        if (container instanceof HTMLElement) {\n            return new this(container, options);\n        }\n        if (typeof container === 'string') {\n            if (document.getElementById(container)) {\n                return new this(document.getElementById(container), options);\n            }\n        }\n        console.error(\"Unable to initialize FPlayer: No valid Container available\");\n    }\n\n    //todo: 和yao对接，完成FPlayer.THEME_ 主题，FPlayer.MODE_ 模式，FPlayer.ACTION_ 事件等常量设置\n    /**\n     * 监听常量，FPlayer加载完成时触发\n     * @type {string}\n     */\n    FPlayer.ACTION_PREPARE_READY = \"prepare_ready\";\n    /**\n     * 监听常量，FPlayer加载失败时触发\n     * @type {string}\n     */\n    FPlayer.ACTION_PREPARE_FAIL = \"prepare_fail\";\n    /**\n     * 监听常量，开始播放时触发\n     * @type {string}\n     */\n    FPlayer.ACTION_ON_PLAY = \"on_play\";\n    /**\n     * 监听常量，音乐加载完成时触发\n     * @type {string}\n     */\n    FPlayer.ACTION_ON_LOAD = \"on_load\";\n    /**\n     * 监听常量，暂停时触发\n     * @type {string}\n     */\n    FPlayer.ACTION_ON_PAUSE = \"on_pause\";\n    /**\n     * 监听常量，切歌时触发\n     * @type {string}\n     */\n    FPlayer.ACTION_ON_SWITCH = \"on_switch\";\n    /**\n     * 监听常量，下一曲触发\n     * @type {string}\n     */\n    FPlayer.ACTION_ON_NEXT = \"on_next\";\n    /**\n     * 监听常量，上一曲触发\n     * @type {string}\n     */\n    FPlayer.ACTION_ON_PREVIOUS = \"on_previous\";\n    /**\n     * 监听常量，失败时触发\n     * @type {string}\n     */\n    FPlayer.ACTION_ON_FAIL = \"on_fail\";\n    /**\n     * 播放模式，单曲循环\n     * @type {string}\n     */\n    FPlayer.MODE_SINGLE = \"single\";\n    /**\n     * 播放模式，列表循环\n     * @type {string}\n     */\n    FPlayer.MODE_LIST = \"list\";\n    /**\n     * 播放模式，列表随机\n     * @type {string}\n     */\n    FPlayer.MODE_RANDOM = \"random\";\n\n    /**\n     * FPlayer将要填充的容器\n     * @type {HTMLElement}\n     */\n    f.mContainer = undefined;\n    /**\n     * FPlayer主题\n     * @type {number}\n     */\n    f.mTheme = undefined;\n    /**\n     * FPlayer音乐列表\n     * @type {Array<Music>}\n     */\n    f.mMusicList = [];\n    /**\n     * FPlayer播放模式\n     * @type {number}\n     */\n    f.mMode = undefined;\n    /**\n     * FPlayer事件监听器\n     * @type {function(FPlayer, string)}\n     * @param {FPlayer} player 监听返回的播放器\n     * @param {string} event 监听ACTION\n     */\n    f.mListener = function (player, event) {\n\n    };\n    /**\n     * 播放失败自动下一曲\n     * @type {boolean}\n     */\n    f.mAutoSkip = true;\n    /**\n     * FPlayer的view\n     * @type {HTMLElement}\n     * @private\n     */\n    f._mView = undefined;\n    /**\n     * 音量\n     * @type {number}\n     * @private\n     */\n    f._mVolume = undefined;\n    /**\n     * 播放列表（真正的播放顺序）\n     * @type {Music[]}\n     * @private\n     */\n    f._mPlayList = [];\n    /**\n     * 当前播放音乐Id\n     * @type {number}\n     * @private\n     */\n    f._mCurrentId = undefined;\n    /**\n     * 当前播放使用的audio标签\n     * @type {HTMLAudioElement}\n     * @private\n     */\n    f._mPlayer = undefined;\n    /**\n     * 当前是否播放音乐\n     * @type {boolean}\n     * @private\n     */\n    f._mIsPlaying = false;\n    /**\n     * 当前音乐的lyric数组\n     * @type {Lyric[]}\n     * @private\n     */\n    f._mCurrentLyric = [];\n    /**\n     * 当前播放到的lyric id\n     * @type {number}\n     * @private\n     */\n    f._mCurrentLyricId = undefined;\n    /**\n     * 该lyric开始时间\n     * @type {number}\n     * @private\n     */\n    f._mCurrentLyricStartTime = undefined;\n    /**\n     * 该lyric停止时间\n     * @type {number}\n     * @private\n     */\n    f._mCurrentLyricEndTime = undefined;\n    /**\n     * 当前是否正显示列表\n     * @type {boolean}\n     * @private\n     */\n    f._mIsShowList = false;\n    /**\n     * 当前是否正显示歌词\n     * @type {boolean}\n     * @private\n     */\n    f._mIsShowLyric = false;\n\n    /**\n     * 设置主题\n     *\n     * @function setTheme\n     * @param {number} theme\n     */\n    f.setTheme = function (theme) {\n        this.mTheme = theme;\n        //todo: 更新view\n    }\n    /**\n     * 获取当前主题\n     * @function getTheme\n     * @returns {number} 主题代码\n     */\n    f.getTheme = function () {\n        return this.mTheme;\n    }\n    /**\n     * 设置音乐列表\n     * @function setMusicList\n     * @param {Array<Music>} list 音乐列表\n     */\n    f.setMusicList = function (list) {\n        this.mMusicList = list;\n        this._updateList();\n        this.switch(0);\n    }\n    /**\n     * 获取音乐列表\n     * @function getMusicList\n     * @returns {Array<Music>}\n     */\n    f.getMusicList = function () {\n        return this.mMusicList;\n    }\n    /**\n     * 添加音乐到列表末尾\n     * @function addMusic\n     * @param {Music} music\n     */\n    f.addMusic = function (music) {\n        this.mMusicList[this.mMusicList.length] = music;\n        this._mPlayList[this._mPlayList.length] = music;\n        if (typeof this._mCurrentId == \"undefined\") {\n            this.switch(0);\n        } else {\n            this._refreshList();\n        }\n        this._updateList();\n    }\n\n    /**\n     * 设置播放模式\n     * @function setMode\n     * @param {number} mode\n     */\n    f.setMode = function (mode) {\n        this.mMode = mode;\n        this._refreshList();\n    }\n    /**\n     * 获取当前播放模式\n     * @function getMode\n     * @returns {number}\n     */\n    f.getMode = function () {\n        return this.mMode;\n    }\n    /**\n     * 设置监听器\n     * @function setListener\n     * @param {function(FPlayer, number)} listener\n     */\n    f.setListener = function (listener) {\n        this.mListener = listener;\n    }\n\n\n    f.openOrCloseList = function (){\n        let list_container = this._mView.querySelector(\".fplayer_list_panel\");\n        if (this._mIsShowList == false) {\n            list_container.style.cssText = \"z-index: 1;transform: translateY(0px);transition: all 600ms cubic-bezier(.23, 1, .32, 1);\";\n            this._mIsShowList = true;\n        } else {\n            list_container.style.cssText = \"z-index:1;transform: translateY(160px);transition: all 600ms cubic-bezier(.23, 1, .32, 1);\";\n            this._mIsShowList = false;\n        }\n    }\n\n    f.openOrCloseLyric = function(){\n        let lyric_container = this._mView.querySelector(\".fplayer_lyric_panel\");\n        let lyric_wrapper = this._mView.querySelector(\".fplayer_lyric_wrapper\");\n        if (this._mIsShowLyric == false) {\n            lyric_container.style.cssText = \"width: 100%;height:100%;transition: all 600ms cubic-bezier(.23, 1, .32, 1);\";\n            lyric_wrapper.style.cssText = \"width:100%;height:100%;overflow: scroll;scrollbar-width: none;margin-left:0%;transition: all 600ms cubic-bezier(.23, 1, .32, 1);\";\n            this._mIsShowLyric = true;\n        } else {\n            lyric_container.style.cssText = \"width: 100%;height:40px;transition: all 600ms cubic-bezier(.23, 1, .32, 1);\";\n            lyric_wrapper.style.cssText = \"width:90%;height:100%;overflow: hidden;position: absolute;transition: all 600ms cubic-bezier(.23, 1, .32, 1);\";\n            this._mIsShowLyric = false;\n        }\n    }\n    /**\n     * 播放逻辑\n     * @function play\n     */\n    f.play = function () {\n        this._mView.querySelector(\".fplayer_play_or_pause\").innerHTML = '<svg width=\"24\" height=\"24\" viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><rect width=\"48\" height=\"48\" fill=\"white\" fill-opacity=\"0.01\"/><path d=\"M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z\" fill=\"none\" stroke=\"#FFF\" stroke-width=\"4\" stroke-linejoin=\"round\"/><path d=\"M19 18V30\" stroke=\"#FFF\" stroke-width=\"4\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/><path d=\"M29 18V30\" stroke=\"#FFF\" stroke-width=\"4\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/></svg>';\n        this._mIsPlaying = true;\n        if (this._mPlayer.readyState >= 2) {\n            this._mPlayer.play()\n                .catch();\n        }\n    }\n    /**\n     * 暂停逻辑\n     * @function pause\n     */\n    f.pause = function () {\n        this._mView.querySelector(\".fplayer_play_or_pause\").innerHTML = '<svg width=\"24\" height=\"24\" viewBox=\"0 0 48 48\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><rect width=\"48\" height=\"48\" fill=\"white\" fill-opacity=\"0.01\"/><path d=\"M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z\" fill=\"none\" stroke=\"#FFF\" stroke-width=\"4\" stroke-linejoin=\"round\"/><path d=\"M20 24V17.0718L26 20.5359L32 24L26 27.4641L20 30.9282V24Z\" fill=\"none\" stroke=\"#FFF\" stroke-width=\"4\" stroke-linejoin=\"round\"/></svg>';\n        this._mIsPlaying = false;\n        this._mPlayer.pause();\n    }\n    /**\n     * 设置进度\n     * @param {number} progress\n     */\n    f.setProgress = function (progress) {\n        if (this._mPlayer.readyState >= 2 && this._mPlayer.duration >= progress) {\n            this._mPlayer.currentTime = progress;\n        }\n    }\n    /**\n     * 音量修改\n     * @param {number} volume\n     */\n    f.setVolume = function (volume) {\n        if(volume >= 0 && volume <= 1){\n            this._mPlayer.volume = volume;\n            return;\n        }\n        console.error(\"FPlayer: Failed to set volume\");\n    }\n    /**\n     * 播放器的下一首逻辑\n     * @function onNext\n     */\n    f.onNext = function () {\n        console.log(\"onNext\");\n        if (this.mMode === fangkehou.FPlayer.MODE_SINGLE) {\n            console.log(\"single mode\");\n            this._pushSong(this._mPlayList[0]);\n            this.mListener(this, fangkehou.FPlayer.ACTION_ON_NEXT);\n            return;\n        }\n        this.next();\n    }\n    /**\n     * 用户指定下一首逻辑\n     * @function next\n     */\n    f.next = function () {\n        let current = this._mPlayList[0];\n        this._mPlayList.shift();\n        this._mPlayList.push(current);\n        current = this._mPlayList[0];\n        this._pushSong(current);\n        this.play();\n        this.mListener(this, fangkehou.FPlayer.ACTION_ON_NEXT);\n    }\n    /**\n     * 用户指定上一首逻辑\n     * @function previous\n     */\n    f.previous = function () {\n        let current = this._mPlayList[this._mPlayList.length - 1];\n        this._mPlayList.unshift(current);\n        this._mPlayList.pop();\n        this._pushSong(current);\n        this.mListener(this, fangkehou.FPlayer.ACTION_ON_PREVIOUS);\n    }\n    /**\n     * 切歌并重新计算播放列表\n     * @function switch\n     * @param {number} id\n     */\n    f.switch = function (id) {\n        this._mPlayList = [];\n        for (let i = id; i < this.mMusicList.length; i++) {\n            this._mPlayList[this._mPlayList.length] = this.mMusicList[i];\n        }\n        for (let i = 0; i < id; i++) {\n            this._mPlayList[this._mPlayList.length] = this.mMusicList[i];\n        }\n        this._refreshList();\n        let current = this._mPlayList[0];\n        this._pushSong(current);\n        this.mListener(this, fangkehou.FPlayer.ACTION_ON_SWITCH);\n    }\n    /**\n     * 更新列表view\n     * @private\n     */\n    f._updateList = function () {\n        if(this.mMusicList.length == 0){\n            return;\n        }\n        let listString = '';\n        for(let i = 0; i < this.mMusicList.length; i++){\n            listString += '<div class=\"fplayer_list_item\" data-id=\"' + i + '\" style=\\'background-image: url(\"' + this.mMusicList[i].cover +'\");\\'>\\n' +\n                '    <p class=\"fplayer_list_content\" style=\"top: 0;\">' + this.mMusicList[i].name + '</p>\\n' +\n                '    <p class=\"fplayer_list_content\" style=\"bottom: 0;\">' + this.mMusicList[i].artist + '</p>\\n' +\n                '</div>'\n        }\n        let listElements = new DOMParser().parseFromString(listString, 'text/html').getElementsByClassName(\"fplayer_list_item\");\n        let listPanel = this._mView.querySelector(\".fplayer_list_panel\");\n        listPanel.innerHTML = '';\n\n        for(let i = 0; i < listElements.length; i++){\n            listElements[i].mFPlayerInstance = this;\n            listElements[i].addEventListener(\"click\", function(){\n                this.mFPlayerInstance.switch(this.dataset.id);\n            })\n            listPanel.appendChild(listElements[i]);\n        }\n    }\n    /**\n     * 重新生成随机列表\n     * @function _refreshList\n     * @private\n     */\n    f._refreshList = function () {\n        if (this.mMode !== fangkehou.FPlayer.MODE_RANDOM) {\n            return;\n        }\n        let current = this._mPlayList[0];\n        this._mPlayList.shift();\n        let l = this._mPlayList.length;\n        let index, temp;\n        while (l > 0) {\n            index = Math.floor(Math.random() * l);\n            temp = this._mPlayList[l - 1];\n            this._mPlayList[l - 1] = this._mPlayList[index];\n            this._mPlayList[index] = temp;\n            l--;\n        }\n        this._mPlayList.unshift(current);\n    }\n    /**\n     * 通过Music类获取id\n     * @function _getIdByMusic\n     * @param {Music} music 待寻找音乐\n     * @returns {number} id\n     * @private\n     */\n    f._getIdByMusic = function (music) {\n        if (this.mMusicList.length == 0) {\n            return -1;\n        }\n        for (let i = 0; i < this.mMusicList.length; i++) {\n            if (music.equals(this.mMusicList[i])) {\n                return i;\n            }\n        }\n        return -1;\n    }\n    /**\n     * 向播放器推送歌曲并初始化\n     * @function _pushSong\n     * @param {Music} music\n     * @private\n     */\n    f._pushSong = function (music) {\n        console.log(\"pushSong\")\n        if (typeof this._mCurrentId != \"undefined\" && music.equals(this.mMusicList[this._mCurrentId])) {\n            console.log(\"single\");\n            if (this._mPlayer.readyState >= 2) {\n                this._mPlayer.play()\n                    .catch();\n            }\n            return;\n        }\n        console.log(\"next\")\n        this._mCurrentId = this._getIdByMusic(music);\n        this._mCurrentLyric = music.lrc;\n        this._switchLyric(0);\n\n        //view更新\n        this._mView.querySelector('.fplayer_detail_title').innerHTML = music.name;\n        this._mView.querySelector('.fplayer_detail_artist').innerHTML = music.artist;\n        this._mView.querySelector('.fplayer_control_panel_background').style.backgroundImage = 'url(\"' + music.cover + '\")';\n\n        //歌词view更新\n        if(music.lrc.length > 0){\n            let lyricString = '';\n            for(let i = 0; i < music.lrc.length; i++){\n                lyricString += '<p data-id=\"' + i + '\">' + music.lrc[i].lyric + '</p>'\n            }\n            this._mView.querySelector('.fplayer_lyric_wrapper').innerHTML = lyricString;\n        }\n\n        this._mPlayer.src = music.content;\n        this._mPlayer.load();\n    }\n    /**\n     * player的监听，负责控制歌词\n     * @param {number} currentTime 当前进度\n     * @private\n     */\n    f._doLyricChange = function(currentTime){\n        if(currentTime >= this._mCurrentLyricStartTime && currentTime < this._mCurrentLyricEndTime){\n            //todo: view更新(日后可能会有)\n        }else if(currentTime >= this._mCurrentLyricEndTime && this._mCurrentLyricId < this._mCurrentLyric.length - 1){\n            for(let i = this._mCurrentLyricId; i < this._mCurrentLyric.length; i++){\n                if(currentTime <= this._mCurrentLyric[i].time){\n                    this._switchLyric(i - 1);\n                    break;\n                }\n            }\n        }else if(currentTime <= this._mCurrentLyricStartTime){\n            for(let i = 0; i < this._mCurrentLyricId + 1; i++){\n                if(currentTime <= this._mCurrentLyric[i].time){\n                    this._switchLyric(i - 1);\n                    break;\n                }\n            }\n        }\n    }\n    /**\n     * 切换歌词到新的一行\n     * @param {number} currentLyricId 应该切换到的歌词id\n     * @private\n     */\n    f._switchLyric = function(currentLyricId){\n        if(currentLyricId < 0){\n            currentLyricId = 0;\n        }\n        if(this._mCurrentLyric[currentLyricId].lyric.length != 0){\n            this._mCurrentLyricId = currentLyricId;\n            this._mCurrentLyricStartTime = this._mCurrentLyric[currentLyricId].time;\n            if(typeof this._mCurrentLyric[currentLyricId + 1] != \"undefined\"){\n                this._mCurrentLyricEndTime = this._mCurrentLyric[currentLyricId + 1].time;\n            }\n            this._mView.querySelector(\".fplayer_lyric_wrapper\").style.top = -40 * currentLyricId + 'px';\n        }else{\n            this._mCurrentLyricId = currentLyricId;\n            this._mCurrentLyricEndTime = this._mCurrentLyric[currentLyricId + 1].time;\n        }\n    }\n\n    fangkehou.FPlayer = FPlayer;\n\n}())\n//fangkehou命名空间，避免混淆\nthis.fangkehou = this.fangkehou || {};\n\n(function () {\n    /**\n     * Lyric 歌词类\n     *\n     * 主要功能为表示和解析歌词，每一个Lyric实例是一行歌词。\n     *\n     * 一般情况下Lyric类会以 Array<Lyric> 的形式出现，Lyric类中也有专门的方法将lrc文件（字符串形式）转换成Lyric数组\n     *\n     * 这是Lyric类的构造函数，同时也承载Lyric的类定义。\n     *\n     * @constructor\n     *\n     * @param {number} time 开始时间\n     * @param {string} lyric 歌词文本\n     *\n     */\n    function Lyric(time, lyric) {\n        this.time = time;\n        this.lyric = lyric;\n    }\n\n    let l = Lyric.prototype;\n    l.constructor = Lyric;\n\n    /**\n     * 这段歌词开始的时间\n     * @type {number}\n     */\n    l.time = undefined;\n    /**\n     * 这段歌词的文本\n     * @type {string}\n     */\n    l.lyric = undefined;\n\n    /**\n     * 可能是Lyric类中唯一的函数了。。。。。负责解析lrc文件（字符串个事）\n     * @param {string} lrcString\n     * @returns {Lyric[]}\n     */\n    Lyric.fromLrcString = function(lrcString){\n        //先把歌词通过回车切分\n        let lyricLines = lrcString.split('\\n');\n        let lyricsList = [];\n        let offset = 0;\n        for(let i = 0; i < lyricLines.length; i++){\n            //去掉每个tag前和后的空格\n            let currentLyric = lyricLines[i].replace(/[\\s]*\\[/g, \"[\").replace(/][\\s]*/g, \"]\");\n            let time = currentLyric.substring(currentLyric.indexOf(\"[\") + 1, currentLyric.indexOf(\"]\")).split(':');\n            //根据定义这里有个offset数值，是歌词整体的偏移量，应该识别一下\n            if(time[0].toLowerCase() == \"offset\"){\n                offset = parseInt(time[1]);\n                continue;\n            }\n            //剩下的非时间标签抛掉就好了，对歌词显示没什么用\n            if(isNaN(parseInt(time[0]))){\n                continue;\n            }\n            //一行歌词可能有多个时间tag，分别代表不同的时间点，应该分出来（这个是lrc格式最烦人的点）\n            let reg = /\\[[0-9:.]*]/g;\n            time = currentLyric.match(reg);\n            let lyricStart = 0;\n            for(let x = 0; x < time.length; x++){\n                lyricStart += time[x].length;\n            }\n            let lyricString = currentLyric.substring(lyricStart);\n            for(let x = 0; x < time.length; x++){\n                let lyricTime = time[x].substring(1, time[x].length);\n                lyricTime = lyricTime.split(':');\n                //把时间转换成秒数（带有一个三位小数表示毫秒）\n                lyricTime = parseFloat(Math.max((parseInt(lyricTime[0]) * 60 + parseFloat(lyricTime[1]) + offset / 1000.0), 0.0).toFixed(3));\n                lyricsList[lyricsList.length] = new fangkehou.Lyric(lyricTime, lyricString);\n            }\n        }\n        //把混乱的歌词排序\n        lyricsList.sort((a, b) => {\n            return a.time - b.time;\n        })\n        return lyricsList;\n    }\n\n    //文档在{@link Lyric}中。。。。。。\n    fangkehou.Lyric = Lyric;\n}())\n//fangkehou命名空间，避免混淆\nthis.fangkehou = this.fangkehou || {};\n\n(function () {\n    /**\n     * Music 歌曲类\n     *\n     * 主要功能为保存歌曲信息，同时也可以处理部分关于歌词和音频内容的参数\n     *\n     * 会自动把lrc格式的歌词转化成Lyric数组，或者把\n     *\n     * 这是Music类的构造函数，同时也承载Music的类定义。\n     *\n     * @class Music\n     * @constructor\n     *\n     * @param {string} name 歌曲名\n     * @param {string} artist 演唱者\n     * @param {string} cover 封面链接\n     * @param {string|Lyric[]} lrc 歌词（可以是排序过的Lyric数组，也可以是Lrc文件（字符串格式））\n     * @param {string|Blob} content 音频内容（可以是链接（本地或在线）或者Blob类）\n     */\n    function Music(name, artist, cover, lrc, content) {\n        this.name = name;\n        this.artist = artist;\n        this.cover = cover;\n        if(typeof lrc === 'string'){\n            this.lrc = fangkehou.Lyric.fromLrcString(lrc);\n        }\n        if(lrc instanceof Array){\n            this.lrc = lrc;\n        }\n        if(typeof content === 'string'){\n            this.content = content;\n        }\n        if(content instanceof Blob){\n            this.content = URL.createObjectURL(content);\n        }\n    }\n\n    let m  = Music.prototype;\n    m.constructor = Music;\n\n    /**\n     * 音乐名称\n     * @type {string}\n     */\n    m.name = undefined;\n    /**\n     * 歌手\n     * @type {string}\n     */\n    m.artist = undefined;\n    /**\n     * 封面（链接，http或blob或base64）\n     * @type {string}\n     */\n    m.cover = undefined;\n    /**\n     * 歌词（Lyric数组）\n     * @type {Lyric[]}\n     */\n    m.lrc = undefined;\n    /**\n     * 音频内容（blob或http）\n     * @type {string}\n     */\n    m.content = undefined;\n    /**\n     * 判断两个Music类是否相同，通过概率判断\n     * @function equals\n     * @param {Music} music\n     */\n    m.equals = function (music) {\n        let result = 0;\n        if(this.name === music.name) {\n            result++;\n        }\n        if(this.artist === music.artist){\n            result++;\n        }\n        if(this.content === music.content){\n            result++;\n        }\n        if(this.cover === music.cover){\n            result++;\n        }\n        if(result >= 2){\n            return true;\n        }\n        return this.lrc === music.lrc;\n\n    }\n\n    //文档在{@link Music}中。。。。。。\n    fangkehou.Music = Music;\n\n}())"],"names":["this","fangkehou","FPlayer","container","options","mContainer","_mView","DOMParser","parseFromString","replaceAll","querySelector","appendChild","let","buttons","getElementsByClassName","i","length","mFPlayerInstance","addEventListener","dataset","action","previous","pause","play","next","openOrCloseList","lyric_panel","list_panel","openOrCloseLyric","mMode","mode","MODE_LIST","mAutoSkip","autoSkip","_mPlayer","Audio","mListener","ACTION_ON_LOAD","_mIsPlaying","catch","console","log","ACTION_ON_NEXT","onNext","ACTION_ON_FAIL","innerText","_doLyricChange","currentTime","f","prototype","constructor","create","HTMLElement","document","getElementById","error","ACTION_PREPARE_READY","ACTION_PREPARE_FAIL","ACTION_ON_PLAY","ACTION_ON_PAUSE","ACTION_ON_SWITCH","ACTION_ON_PREVIOUS","MODE_SINGLE","MODE_RANDOM","undefined","mTheme","mMusicList","player","event","_mVolume","_mPlayList","_mCurrentId","_mCurrentLyric","_mCurrentLyricId","_mCurrentLyricStartTime","_mCurrentLyricEndTime","_mIsShowList","_mIsShowLyric","setTheme","theme","getTheme","setMusicList","list","_updateList","switch","getMusicList","addMusic","music","_refreshList","setMode","getMode","setListener","listener","list_container","style","cssText","lyric_container","lyric_wrapper","innerHTML","readyState","setProgress","progress","duration","setVolume","volume","_pushSong","current","shift","push","unshift","pop","id","listString","cover","name","artist","listElements","listPanel","index","temp","l","Math","floor","random","_getIdByMusic","equals","lrc","_switchLyric","backgroundImage","lyricString","lyric","src","content","load","time","currentLyricId","top","Lyric","fromLrcString","lrcString","lyricLines","split","lyricsList","offset","currentLyric","replace","substring","indexOf","toLowerCase","isNaN","parseInt","match","lyricStart","x","lyricTime","parseFloat","max","toFixed","sort","a","b","Music","Array","Blob","URL","createObjectURL","m","result"],"mappings":"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"}